import{U as e,$ as o,R as n,M as t,O as a,j as l,E as u,D as i,e as c}from"./vendor.3b3f849b.js";import{u as r}from"./useLayer.937b5043.js";import{a as s,n as d}from"./util.cb618057.js";import{I as p}from"./Input.2767a10d.js";import{s as f}from"./index.f7e44da3.js";function v({value:e,options:o,onChange:n,renderOption:t,onActiveOptionChange:a,activeOptionIndex:i,renderValue:v,onFocus:m,onBlur:b,focused:g,ref:h},O){const x=c(),w=e=>{["ArrowDown","ArrowUp","Enter"].includes(e.code)&&(e.preventDefault(),e.stopPropagation(),"ArrowDown"===e.code?i.value<o.length-1&&a(i.value+1):"ArrowUp"===e.code?i.value>-1&&a(i.value-1):"Enter"===e.code&&(n(o[i.value]),b()))},{source:I,node:y}=r((e=>l("optionList",{inline:!0,"inline-display-none":u((()=>!g.value)),"inline-min-width":u((()=>`${e.value?e.value.offsetWidth:0}px`)),tabindex:-1,onKeyDown:w,onFocusOut:()=>b(),style:{background:"#fff",zIndex:99},ref:x},(()=>o.map(((e,o)=>O.optionItem({option:e,index:o})(l("optionItem",{block:!0,"block-font-size":f().fontSize(),"block-padding":`${f().spacing(-1)}px ${f().spacing()}px `,onClick:()=>{n(e),b()}},t(e)))))))),{getContainerRect:({top:e,left:o,height:n})=>({top:n+e,left:o})});return l("container",{block:!0,"flex-display-inline":!0},l("selectInput",{"layout:inline":!0,"layout:inline-max-width":"100%",use:p,ref:s(h,I),onFocus:()=>{m(),d((()=>x.current.focus()))},focused:g,onBlur:()=>!1,value:u((()=>v(e)))}),y)}function m(e){}function b(e){e.root.modify(((e,{onFocus:o,onBlur:n,focused:t,activeOptionIndex:a,onActiveOptionChange:l,inputToValue:u,onChange:r,options:d,onRenderOptionChange:p,onPressEnter:f})=>{const v=e.children[0],m=c();v.ref=s(v.ref,m);Object.assign(v.attributes,{onFocus:()=>o(),onChange:({value:e})=>{const o=u(e.value);r(o),p(o)},onKeyDown:e=>{["ArrowDown","ArrowUp","Enter"].includes(e.code)&&(e.preventDefault(),e.stopPropagation(),"ArrowDown"===e.code?a.value<d.length-1&&l(a.value+1):"ArrowUp"===e.code?a.value>-1&&l(a.value-1):"Enter"===e.code&&(f(),m.current.blur(),n()))},onBlur:i((()=>{setTimeout((()=>{t.value&&n()}),50)}))})}))}v.propTypes={value:e.object.default((()=>o(void 0))),options:e.object.default((()=>n([]))),activeOptionIndex:e.object.default((()=>o(-1))),focused:e.bool.default((()=>o(!1))),onFocus:e.callback.default((()=>({focused:e,activeOptionIndex:o})=>{e.value=!0,o.value=-1})),onBlur:e.callback.default((()=>({focused:e,activeOptionIndex:o})=>{e.value=!1,o.value=-1})),match:e.function.default((()=>(e,o)=>!!e.value&&e.value.id===o.id)),renderOption:e.function.default((()=>e=>e.name)),renderValue:e.function.default((()=>e=>e.value?e.value.name:"")),optionToValue:e.function.default((()=>e=>Object.assign({},e))),onChange:e.callback.default((()=>(e,{value:o,optionToValue:n})=>{o.value=n(e)})),onActiveOptionChange:e.callback.default((()=>(e,{activeOptionIndex:o})=>{o.value=e}))},v.Style=e=>{e.optionItem.elements.optionItem.style((({value:e,option:o,match:n,index:t,activeOptionIndex:a})=>{const l=n(e,o),u=a.value===t;return{background:l||u?f().inverted().active().bgColor(u?-2:0):f().active().bgColor(),color:l?f().interactable().active().inverted().color():f().color(),cursor:"pointer"}})),e.root.elements.optionList.style({boxShadow:f().elevate().shadow()})},v.forwardRef=!0,m.propTypes={searchable:e.object.default((()=>o(!1))),allOptions:e.object.default((()=>n([])))},b.match=({recommendMode:e})=>e,b.propTypes={allOptions:e.object.default((()=>n([]))),recommendMode:e.feature.default((()=>!1)),delegateValue:e.function.default((()=>e=>t(e).name)),inputToValue:e.function.default((()=>e=>({name:e}))),filter:e.function.default((()=>(e,o)=>o.filter((o=>new RegExp(`${e.name}`).test(o.name))))),onRenderOptionChange:e.callback.default((()=>(e,{options:o,filter:n,allOptions:t})=>{o.splice(0,o.length,...n(e,t))})),matchInputValue:e.function.default((()=>(e,o)=>e.value.name===o.name)),onPressEnter:e.callback.default((()=>({value:e,onChange:o,matchInputValue:n,options:t,activeOptionIndex:a})=>{if(t[a.value])o(t[a.value]);else{const a=t.find((o=>n(e,o)));a&&o(a)}}))};var g=a(v,[m,b]);export{g as S};
